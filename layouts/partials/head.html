<head>
  <meta charset="utf-8" />
  <base href="{{ .Site.BaseURL }}">
  {{/*  Dynamic site title. Default site title is used on homepage. On any other page, the page title with the company name piped next to it is used.  */}}
  <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ if .Params.heading }}{{ .Params.heading }} | {{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}{{ end }}</title>
  {{ hugo.Generator }}
  <meta name="author" content="{{ .Site.Title }}">
  {{/*  Dynamic site description. Default site description is used on homepage. On any other page, the description found in the front matter is used.  */}}
  {{/*  Theme for PWA  */}}
  <meta name="theme-color" content="#8F3A6D">
  
  {{/*  Open Graph  */}}
  {{ template "_internal/schema.html" . }}
  <meta name="twitter:site" content="@{{ .Site.Params.social }}">
  {{ template "_internal/twitter_cards.html" . }}
  {{ $avatar := resources.Get "icons/avatar.png" }}
  <meta name="twitter:image" content="{{ $avatar.Permalink }}">
  {{ template "_internal/opengraph.html" . }}
  <meta property="og:image" content="{{ $avatar.Permalink }}">

  {{/*  Viewport  */}}
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,initial-scale=1.0,maximum-scale=5.0,viewport-fit=cover">

  {{/*  Webclip and Apple Touch Icon  */}}
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="{{ .Site.Title }}">
  {{ $ati152 := resources.Get "icons/apple-touch-icon-152x152.png" }}
  <link rel="apple-touch-icon" sizes="152x152" href="{{ $ati152.Permalink }}">
  {{ $ati167 := resources.Get "icons/apple-touch-icon-167x167.png" }}
  <link rel="apple-touch-icon" sizes="167x167" href="{{ $ati167.Permalink }}">
  {{ $ati180 := resources.Get "icons/apple-touch-icon-180x180.png" }}
  <link rel="apple-touch-icon" sizes="180x180" href="{{ $ati180.Permalink }}">
  {{ $spt := resources.Get "icons/safari-pinned-tab.svg" | minify }}
  <link rel="mask-icon" color="#8F3A6D" href="{{ $spt.Permalink }}">

  {{/*  Android Chrome Icon  */}}
  {{ $i128 := resources.Get "icons/icon-128x128.png" }}
  <link rel="icon" sizes="128x128" href="{{ $i128.Permalink }}">
  {{ $i192 := resources.Get "icons/icon-192x192.png" }}
  <link rel="icon" sizes="192x192" href="{{ $i192.Permalink }}">
  {{ $i512 := resources.Get "icons/icon-512x512.png" }}
  <link rel="icon" sizes="512x512" href="{{ $i512.Permalink }}">

  {{/*  Favicon  */}}
  {{ $favicon := resources.Get "icons/favicon.png" }}
  <link rel="shortcut icon" href="{{ $favicon.Permalink }}">

  {{/*  Site URL  */}}
  <link rel="canonical" href="{{ .Permalink }}">

  {{/*  Manifest  */}}
  {{ $manifest := resources.Get "manifest.json" }}
  <link rel="manifest" href="{{ $manifest.Permalink }}">

  {{/*  RSS  */}}
  {{ if eq .Type "writing" }}
  <link href='{{ "writing/index.xml" | relURL }}' rel="alternate" type="application/rss+xml" title="{{ .Site.Title }}">
  <link href='{{ "writing/feed.json" | relURL }}' rel="alternate" type="application/json" title="{{ .Site.Title }}" />
  {{ end }}

  {{/*  Critical CSS  */}}
  {{ partial "critical.html" . }}

  {{/*  Theme  */}}
  <script>
    const compStyles = window.getComputedStyle(document.querySelector('html'));
    let theme = compStyles.getPropertyValue('--theme').replace(' ', '');
    let color = localStorage.getItem('theme');

    window.addEventListener('DOMContentLoaded', (event) => {
      switch (color || theme) {
        case 'dark':
          document.querySelector('html').setAttribute('data-theme', 'dark');
          document.querySelector('#theme').checked = true;
          break;
        case 'light':
          document.querySelector('html').setAttribute('data-theme', 'light');
          document.querySelector('#theme').checked = false;
          break;
      }
    });
  </script>

  {{/*  Stylesheets  */}}
  {{ $critical := resources.Get "css/critical.css" }}
  {{ $reset := resources.Get "css/reset.css" }}
  {{ $components := resources.Get "css/components.css" }}
  {{ $main := resources.Get "css/main.css" }}
  {{ $styles := slice $critical $reset $components $main | resources.Concat "styles.css" | postCSS | minify }}
  <link rel="stylesheet" href="{{ $styles.Permalink }}">
  {{ if eq .Params.code true }}
  {{ $syntax := resources.Get "css/syntax.css" }}
  <link rel="prefetch" as="style" onload="this.rel = 'stylesheet'" href="{{ $syntax.Permalink }}">
  <noscript>
    <link rel="stylesheet" href="{{ $syntax.Permalink }}">
  </noscript>
  {{ end }}
</head>