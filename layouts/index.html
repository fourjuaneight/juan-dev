{{ define "main" }}
  <main class="main">
    <section id="intro" class="main__section main__section--intro">
      {{ partial "avatar.html" . }}
      <div class="boxed main__hero">
        <h1 class="main__title">{&nbsp;Hi, I'm <a href='{{ "about" | relURL }}' class="title__link">Juan</a>.&nbsp;}</h1>
        <p class="main__copy">I'm a Front-End Developer, automation nerd, and astronomy enthusiast currently working independently. I help businesses build accessible and performant static sites with the <a href="https://jamstack.org" class="title__link" target="_blank" rel="noopener noreferrer">JAMstack</a>.</p>
      </div>
    </section>
    <section id="work" class="content__container main__section main__section--work">
      <h2 class="boxed main__subtitle">{&nbsp;Work&nbsp;}</h2>
      <ul class="boxed main__work-list">
        {{/*  Loop over work data file and get client object values.  */}}
        {{ range $i, $client := .Site.Data.work.recent }}
        <li class="main__work-item">
          {{/*  Grab client name, replace space with dashes, change to lower case. This generates the image filename.  */}}
          {{ $clientImg := replaceRE " " "-" $client.name | lower }}
          {{ $webp := resources.Get (print "img/" $clientImg ".webp") }}
          {{ $img := resources.Get (print "img/" $clientImg ".png") }}
          <a href="{{ $client.website }}" target="_blank" rel="noopener noreferrer">
            <picture class="main__img main__img--client">
              <source srcset="{{ $webp.Permalink }}" type="image/webp">
              <source srcset="{{ $img.Permalink }}" type="image/png">
              <img src="{{ $img.Permalink }}" alt="{{ $client.name }} website screenshot."/>
            </picture>
          </a>
          <div class="work__header">
            <a href="{{ $client.website }}" class="font--fira main__client-name" target="_blank" rel="noopener noreferrer">{{ $client.name }}</a>
            <time class="font--fira main__client-date" datetime="{{ $client.date }}">{{ $client.date }}</time>
          </div>
          <p class="work__client-description">{{ $client.description }}</p>
          <ul class="font--fira work__skills-list">
            {{ range $key, $skill := $client.skills }}
              {{- if ne $key 0 }}<span class="color--prompt" aria-hidden="true">::</span>{{ end }}
              <li class="main__skill">{{ $skill }}</li>
            {{ end }}
          </ul>
        </li>
        {{ end }}
      </ul>
    </section>
    <section id="writing" class="content__container main__section main__section--writing">
      <h2 class="boxed main__subtitle">{&nbsp;Writing&nbsp;}</h2>
      {{/*  Get last 5 writing post and range over them.  */}}
      {{ $writing := ($.Site.GetPage "section" "writing").Pages }}
      <ul class="boxed writing__list">
        {{ range last 4 $writing }}
          <li class="writing__list--entry">{{ .Render "summary" }}</li>
        {{ end }}
      </ul>
      <a href='{{ "writing" | relURL }}' class="font--fira main__nav-link">Read more</a>
    </section>
  </main>
{{ end }}
